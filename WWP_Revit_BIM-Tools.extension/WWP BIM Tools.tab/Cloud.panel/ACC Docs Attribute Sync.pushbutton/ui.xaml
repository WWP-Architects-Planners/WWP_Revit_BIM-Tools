<Window
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="ACC Docs Attribute Sync"
    Height="720"
    Width="1080"
    WindowStartupLocation="CenterScreen"
    Background="#F4F4F2"
    FontFamily="Segoe UI">
    <Window.Resources>
        <LinearGradientBrush x:Key="PanelBrush" StartPoint="0,0" EndPoint="0,1">
            <GradientStop Color="#FFFFFF" Offset="0" />
            <GradientStop Color="#F7F7F5" Offset="1" />
        </LinearGradientBrush>

        <Style TargetType="TextBox">
            <Setter Property="Margin" Value="0,4,0,8" />
            <Setter Property="Padding" Value="8,6" />
        </Style>

        <Style TargetType="PasswordBox">
            <Setter Property="Margin" Value="0,4,0,8" />
            <Setter Property="Padding" Value="8,6" />
        </Style>

        <Style TargetType="ComboBox">
            <Setter Property="Margin" Value="0,4,0,8" />
            <Setter Property="Padding" Value="6,4" />
        </Style>

        <HierarchicalDataTemplate x:Key="FolderTemplate" ItemsSource="{Binding Children}">
            <StackPanel x:Name="FolderRow" Orientation="Horizontal" VerticalAlignment="Center">
                <Viewbox x:Name="FolderIcon" Width="16" Height="16">
                    <Path Fill="#F2C94C" Stroke="#C28F2C" StrokeThickness="0.8"
                          Data="M2,6 H9 L11,8 H22 V20 H2 Z" />
                </Viewbox>
                <TextBlock x:Name="FolderName" Text="{Binding Name}" Margin="6,0,0,0" />
            </StackPanel>
            <HierarchicalDataTemplate.Triggers>
                <DataTrigger Binding="{Binding IsPlaceholder}" Value="True">
                    <Setter TargetName="FolderName" Property="Text" Value="Loading..." />
                    <Setter TargetName="FolderName" Property="FontStyle" Value="Italic" />
                    <Setter TargetName="FolderName" Property="Foreground" Value="#8B8B8B" />
                    <Setter TargetName="FolderIcon" Property="Opacity" Value="0.35" />
                </DataTrigger>
            </HierarchicalDataTemplate.Triggers>
        </HierarchicalDataTemplate>

        <DataTemplate x:Key="FileTemplate">
            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                <Viewbox Width="14" Height="14">
                    <Path Fill="#8AA0B2" Stroke="#586574" StrokeThickness="0.8"
                          Data="M4,2 H14 L18,6 V20 H4 Z M14,2 V6 H18" />
                </Viewbox>
                <TextBlock Text="{Binding DisplayName}" Margin="6,0,0,0" />
            </StackPanel>
        </DataTemplate>
    </Window.Resources>

    <Grid Margin="16">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="320" />
            <ColumnDefinition Width="8" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <Border Grid.Column="0" Background="{StaticResource PanelBrush}" CornerRadius="10" Padding="14">
            <DockPanel LastChildFill="True">
                <TextBlock DockPanel.Dock="Top" Text="ACC Docs" FontSize="18" FontWeight="SemiBold" />
                <TextBlock DockPanel.Dock="Top" Text="Authenticate, pick a project, then select folders." Margin="0,6,0,14" Foreground="#4F4F4F" />

                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <TextBlock x:Name="ClientIdLabel" Text="Client ID" FontWeight="SemiBold" />
                        <TextBox x:Name="ClientIdBox" />

                        <TextBlock x:Name="ClientSecretLabel" Text="Client Secret" FontWeight="SemiBold" />
                        <PasswordBox x:Name="ClientSecretBox" />

                        <TextBlock Text="Tip: If a .env is present, these fields are auto-filled."
                                   Foreground="#6B6B6B" FontSize="11" Margin="0,-2,0,8" />

                        <TextBlock x:Name="RedirectUriLabel" Text="Redirect URI" FontWeight="SemiBold" Visibility="Collapsed" />
                        <TextBox x:Name="RedirectUriBox" IsReadOnly="True" Visibility="Collapsed" />

                        <Button x:Name="LoginButton" Content="Sign In" Height="32" Margin="0,6,0,12" />

                        <Separator Margin="0,8,0,8" />

                        <TextBlock Text="Hub" FontWeight="SemiBold" />
                        <ComboBox x:Name="HubCombo" />

                        <TextBlock Text="Project" FontWeight="SemiBold" />
                        <ComboBox x:Name="ProjectCombo" />

                        <TextBlock Text="Project Folder URL" FontWeight="SemiBold" />
                        <TextBox x:Name="FolderUrlBox" />
                        <Button x:Name="LoadFolderButton" Content="Load Folder" Height="30" Margin="0,4,0,8" />

                        <TextBlock Text="Folders" FontWeight="SemiBold" Margin="0,8,0,4" />
                        <Border BorderBrush="#DDDDDD" BorderThickness="1" CornerRadius="6" Height="260">
                            <TreeView x:Name="FolderTree" ItemTemplate="{StaticResource FolderTemplate}" />
                        </Border>

                        <Button x:Name="RefreshFoldersButton" Content="Refresh Folders" Height="30" Margin="0,8,0,0" />
                    </StackPanel>
                </ScrollViewer>
            </DockPanel>
        </Border>

        <GridSplitter Grid.Column="1" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Width="8" />

        <Grid Grid.Column="2">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>

            <Border Grid.Row="0" Background="#FFFFFF" CornerRadius="10" Padding="12" Margin="0,0,0,10">
                <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                    <TextBlock Text="Status:" FontWeight="SemiBold" />
                    <TextBlock x:Name="StatusText" Text="Not signed in" Margin="6,0,0,0" Foreground="#4F4F4F" />
                </StackPanel>
            </Border>

            <Grid Grid.Row="1">
                <Grid.RowDefinitions>
                    <RowDefinition Height="*" />
                    <RowDefinition Height="6" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>

                <Border Grid.Row="0" Background="#FFFFFF" CornerRadius="10" Padding="12" Margin="0,0,0,10">
                    <DockPanel>
                        <DockPanel DockPanel.Dock="Top" Margin="0,0,0,8">
                            <TextBlock Text="Files in Selected Folder" FontWeight="SemiBold" />
                            <Button x:Name="RefreshFilesButton" Content="Refresh Files" Width="110" Height="26" Margin="10,0,0,0" HorizontalAlignment="Right" />
                        </DockPanel>
                        <ListView x:Name="FileList">
                            <ListView.View>
                                <GridView>
                                    <GridViewColumn Header="File" CellTemplate="{StaticResource FileTemplate}" Width="260" />
                                    <GridViewColumn Header="Type" DisplayMemberBinding="{Binding ExtensionType}" Width="200" />
                                    <GridViewColumn Header="Description" DisplayMemberBinding="{Binding Description}" Width="260" />
                                    <GridViewColumn Header="Item Id" DisplayMemberBinding="{Binding Id}" Width="360" />
                                </GridView>
                            </ListView.View>
                        </ListView>
                    </DockPanel>
                </Border>

                <GridSplitter Grid.Row="1" Height="6" HorizontalAlignment="Stretch" VerticalAlignment="Center" Background="#E0E0E0" />

                <Border Grid.Row="2" Background="#FFFFFF" CornerRadius="10" Padding="12">
                    <DockPanel>
                        <TextBlock DockPanel.Dock="Top" Text="Log" FontWeight="SemiBold" Margin="0,0,0,6" />
                        <TextBox x:Name="LogBox" IsReadOnly="True" AcceptsReturn="True" VerticalScrollBarVisibility="Auto" TextWrapping="Wrap" />
                    </DockPanel>
                </Border>
            </Grid>

            <Border Grid.Row="2" Background="#FFFFFF" CornerRadius="10" Padding="12" Margin="0,10,0,0">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="120" />
                        <ColumnDefinition Width="160" />
                    </Grid.ColumnDefinitions>
                    <StackPanel Grid.Column="0">
                        <TextBlock Text="Excel Mapping" FontWeight="SemiBold" />
                        <TextBox x:Name="ExcelPathBox" IsReadOnly="True" />
                        <TextBlock x:Name="ExcelStatusText" Text="Column A = File Name. Column headers map to attributes (description)." Foreground="#4F4F4F" />
                    </StackPanel>
                    <Button x:Name="BrowseExcelButton" Grid.Column="1" Content="Browse" Height="30" Margin="8,18,8,0" />
                    <Button x:Name="ApplyButton" Grid.Column="2" Content="Apply Descriptions" Height="30" Margin="8,18,0,0" />
                </Grid>
            </Border>
        </Grid>
    </Grid>
</Window>
