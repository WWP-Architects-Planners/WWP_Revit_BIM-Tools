<Window
    x:Class="BEPDesigner.WinUI.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:models="using:BEPDesigner.WinUI.Models"
    xmlns:controls="using:Microsoft.UI.Xaml.Controls"
    mc:Ignorable="d"
    Title="WWP BIM Execution Planner">

    <Grid RequestedTheme="Light">
        <Grid.Resources>
            <Color x:Key="SystemAccentColor">#FF118DFF</Color>
            <Color x:Key="SystemAccentColorLight1">#FF3CA6FF</Color>
            <Color x:Key="SystemAccentColorLight2">#FF66B9FF</Color>
            <Color x:Key="SystemAccentColorLight3">#FF8DCCFF</Color>
            <Color x:Key="SystemAccentColorDark1">#FF0A74DD</Color>
            <Color x:Key="SystemAccentColorDark2">#FF085EB3</Color>
            <Color x:Key="SystemAccentColorDark3">#FF06498A</Color>

            <Style TargetType="Button">
                <Setter Property="Background" Value="#FFE2E5E9" />
                <Setter Property="Foreground" Value="#FF1F2328" />
                <Setter Property="BorderBrush" Value="#FFC9CDD2" />
            </Style>

            <Style TargetType="ToggleSwitch">
                <Setter Property="Width" Value="62" />
                <Setter Property="Height" Value="32" />
                <Setter Property="MinWidth" Value="62" />
                <Setter Property="MinHeight" Value="32" />
                <Setter Property="VerticalAlignment" Value="Center" />
                <Setter Property="OnContent" Value="" />
                <Setter Property="OffContent" Value="" />
            </Style>
        </Grid.Resources>
        <Grid.Background>
            <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                <GradientStop Color="#FFF3F3F4" Offset="0" />
                <GradientStop Color="#FFE9E9EC" Offset="0.45" />
                <GradientStop Color="#FFDDDEE2" Offset="1" />
            </LinearGradientBrush>
        </Grid.Background>

        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <Border Margin="20,18,20,12" Padding="20" CornerRadius="18" Background="#FFFFFFFF" BorderBrush="#FFD0D5DB" BorderThickness="1">
            <Grid ColumnSpacing="16">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <StackPanel>
                    <TextBlock Text="WWP BIM EXECUTION PLAN BUILDER" FontSize="13" FontWeight="SemiBold" Foreground="#FF3E454D" />
                    <TextBlock Text="ACC Collaboration + Topic Control" FontSize="30" FontWeight="Bold" Margin="0,4,0,0" />
                    <TextBlock Text="Fill original DOCX while preserving formatting and controlling included topics." Opacity="0.82" Margin="0,6,0,0" />
                </StackPanel>

                <Border Grid.Column="1" Padding="14,8" CornerRadius="8" Background="#FFD0D0D4" VerticalAlignment="Center">
                    <TextBlock Text="WW+P" FontSize="32" FontWeight="Normal" Foreground="#FF111111" />
                </Border>
            </Grid>
        </Border>

        <Border Grid.Row="1" Margin="20,0,20,0" Padding="12" CornerRadius="16" Background="#FFEEEFF2" BorderBrush="#FFCBCCD1" BorderThickness="1">
            <controls:TabView IsAddTabButtonVisible="False">
                <controls:TabView.Resources>
                    <Style TargetType="controls:TabViewItem">
                        <Setter Property="FontSize" Value="14" />
                        <Setter Property="FontWeight" Value="SemiBold" />
                    </Style>
                </controls:TabView.Resources>

                <controls:TabViewItem Header="Project">
                    <ScrollViewer>
                        <StackPanel Spacing="14" Padding="8">
                            <Border Background="#FFFFFFFF" CornerRadius="14" Padding="18" BorderBrush="#FFD7DBE0" BorderThickness="1">
                                <StackPanel Spacing="12">
                                    <TextBlock Text="Project Information" FontSize="22" FontWeight="SemiBold" />
                                    <Grid ColumnSpacing="12" RowSpacing="10">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                        </Grid.RowDefinitions>

                                        <TextBox x:Name="ProjectNameBox" Header="Project Name" PlaceholderText="118 Project Avenue" Grid.Row="0" Grid.Column="0" />
                                        <TextBox x:Name="ProjectNumberBox" Header="Project Number" PlaceholderText="SvN Internal Number" Grid.Row="0" Grid.Column="1" />
                                        <TextBox x:Name="ProjectAddressBox" Header="Project Address" Grid.Row="1" Grid.ColumnSpan="2" />
                                        <TextBox x:Name="ClientBox" Header="Project Owner / Client" Grid.Row="2" Grid.Column="0" />
                                        <TextBox x:Name="ProjectTypeBox" Header="Project Type" Grid.Row="2" Grid.Column="1" />
                                        <TextBox x:Name="ContractTypeBox" Header="Contract Type" Grid.Row="3" Grid.Column="0" />
                                        <TextBox x:Name="ProjectDescriptionBox" Header="Project Description" Grid.Row="3" Grid.Column="1" />
                                    </Grid>
                                </StackPanel>
                            </Border>

                            <Border Background="#FFFFFFFF" CornerRadius="14" Padding="18" BorderBrush="#FFD7DBE0" BorderThickness="1">
                                <StackPanel Spacing="12">
                                    <TextBlock Text="Roles + Collaboration" FontSize="22" FontWeight="SemiBold" />
                                    <Grid ColumnSpacing="12" RowSpacing="10">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <TextBox x:Name="BimLeadBox" Header="BIM Lead / Manager" />
                                        <TextBox x:Name="CoordinationMeetingBox" Header="Coordination Meeting Cadence" Grid.Column="1" PlaceholderText="Bi-Weekly Wednesday 4:00pm EDT" />
                                    </Grid>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </ScrollViewer>
                </controls:TabViewItem>

                <controls:TabViewItem Header="ACC Workflow">
                    <ScrollViewer>
                        <StackPanel Spacing="14" Padding="8">
                            <Border Background="#FFFFFFFF" CornerRadius="14" Padding="18" BorderBrush="#FFD7DBE0" BorderThickness="1">
                                <StackPanel Spacing="12">
                                    <TextBlock Text="ACC Package Strategy" FontSize="22" FontWeight="SemiBold" />
                                    <ComboBox x:Name="PackageMethodBox" Header="Primary Coordination Method">
                                        <ComboBoxItem Content="1. Live Model" />
                                        <ComboBoxItem Content="2. Shared Package" />
                                        <ComboBoxItem Content="3. Consumed Model" />
                                    </ComboBox>

                                    <Grid ColumnSpacing="10">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <TextBox x:Name="AutoPublishBox" Header="Auto-Publish Cadence" PlaceholderText="Friday 22:00 EST" Grid.Column="0" />
                                        <ComboBox x:Name="SharingFrequencyBox" Header="Package Sharing Timeline" Grid.Column="1">
                                            <ComboBoxItem Content="Weekly" />
                                            <ComboBoxItem Content="Bi-Weekly" />
                                            <ComboBoxItem Content="At Issuances" />
                                            <ComboBoxItem Content="Custom" />
                                        </ComboBox>
                                    </Grid>

                                    <TextBox x:Name="PackageNamingBox" Header="Package Naming Convention" PlaceholderText="&lt;Project&gt;_Shared for &lt;Purpose&gt;" />

                                    <Border Background="#FFF5F6F8" BorderBrush="#FFDCE0E5" BorderThickness="1" CornerRadius="8" Padding="10">
                                        <StackPanel Spacing="8">
                                            <TextBlock Text="Geo-Referencing Inputs" FontWeight="SemiBold" />
                                            <TextBox x:Name="GeoCoordinateSystemBox" Header="Geocoordinate system" PlaceholderText="e.g. NAD83 / UTM Zone 17N" />
                                            <TextBox x:Name="AcquireCoordinatesModelBox" Header="Coordinates acquired from model" PlaceholderText="e.g. ARCH_160_John_Street.rvt" />
                                        </StackPanel>
                                    </Border>

                                    <Border Background="#FFF5F6F8" BorderBrush="#FFDCE0E5" BorderThickness="1" CornerRadius="8" Padding="10">
                                        <StackPanel Spacing="8">
                                            <TextBlock Text="Approved Software Versions" FontWeight="SemiBold" />
                                            <Grid ColumnSpacing="10" RowSpacing="8">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*" />
                                                    <ColumnDefinition Width="*" />
                                                </Grid.ColumnDefinitions>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition Height="Auto" />
                                                </Grid.RowDefinitions>
                                                <TextBox x:Name="RevitVersionBox" Header="Autodesk Revit" PlaceholderText="2024.2" Grid.Row="0" Grid.Column="0" />
                                                <TextBox x:Name="AutoCadVersionBox" Header="Autodesk AutoCAD" PlaceholderText="2024" Grid.Row="0" Grid.Column="1" />
                                                <TextBox x:Name="Civil3DVersionBox" Header="Autodesk Civil 3D" PlaceholderText="2024" Grid.Row="1" Grid.Column="0" />
                                                <TextBox x:Name="DesktopConnectorVersionBox" Header="Autodesk Desktop Connector" PlaceholderText="x.x.x" Grid.Row="1" Grid.Column="1" />
                                                <TextBox x:Name="BluebeamVersionBox" Header="Bluebeam Revu" PlaceholderText="x.x.x" Grid.Row="2" Grid.Column="0" />
                                            </Grid>
                                        </StackPanel>
                                    </Border>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </ScrollViewer>
                </controls:TabViewItem>

                <controls:TabViewItem Header="Topics">
                    <ScrollViewer>
                        <StackPanel Spacing="14" Padding="8">
                            <Border Background="#FFFFFFFF" CornerRadius="14" Padding="16" BorderBrush="#FFD7DBE0" BorderThickness="1">
                                <StackPanel Spacing="8">
                                    <TextBlock Text="Topic Selection (unchecked topics are removed in filled DOCX)" FontWeight="SemiBold" />
                                    <TextBlock x:Name="TopicSelectionText" Text="0 selected" Foreground="#FF555F6B" />
                                    <StackPanel Orientation="Horizontal" Spacing="8">
                                        <Button Content="Select All" Click="SelectAllTopicsButton_Click" />
                                        <Button Content="Select None" Click="SelectNoneTopicsButton_Click" />
                                        <Button Content="Keep Essential" Click="KeepEssentialTopicsButton_Click" />
                                        <Button Content="Reload Topics" Click="ReloadTopicsButton_Click" />
                                    </StackPanel>
                                    <ListView x:Name="TopicsListView" Height="420" SelectionMode="None">
                                        <ListView.ItemTemplate>
                                            <DataTemplate x:DataType="models:TopicOption">
                                                <Border Background="#FFFDFEFF" BorderBrush="#FFE6EBF2" BorderThickness="1" CornerRadius="6" Padding="8" Margin="0,2,0,2">
                                                    <StackPanel Spacing="6">
                                                        <TextBlock
                                                            Text="{x:Bind GroupTitle}"
                                                            Visibility="{x:Bind GroupHeaderVisibility}"
                                                            FontWeight="SemiBold"
                                                            Foreground="#FF2C3E50"
                                                            Margin="0,0,0,2" />
                                                        <CheckBox
                                                            Content="{x:Bind Name}"
                                                            Margin="{x:Bind IndentMargin}"
                                                            IsChecked="{x:Bind Keep, Mode=TwoWay}"
                                                            Checked="TopicCheck_Changed"
                                                            Unchecked="TopicCheck_Changed" />
                                                    </StackPanel>
                                                </Border>
                                            </DataTemplate>
                                        </ListView.ItemTemplate>
                                    </ListView>
                                    <TextBlock Text="Output is always rebuilt from the original template, so removed topics are recoverable. For TOC/page numbers in Word: Ctrl+A, then F9." TextWrapping="Wrap" Foreground="#FF555F6B" />
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </ScrollViewer>
                </controls:TabViewItem>

                <controls:TabViewItem Header="Output &amp; Export">
                    <Grid Padding="8" RowSpacing="12">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>

                        <Border Background="#FFFFFFFF" CornerRadius="14" Padding="16" BorderBrush="#FFD7DBE0" BorderThickness="1">
                            <StackPanel Spacing="8">
                                <StackPanel Orientation="Horizontal" Spacing="10">
                                    <Button x:Name="ChooseTemplateButton" Content="Choose Original DOCX" Click="ChooseTemplateButton_Click" Background="#FFD8DADF" />
                                    <Button x:Name="FillTemplateDocxButton" Content="Generate BEP DOCX" Click="FillTemplateDocxButton_Click" Background="#FFD8DADF" />
                                    <StackPanel Orientation="Horizontal" Spacing="8" VerticalAlignment="Center">
                                        <TextBlock Text="Open after generate" VerticalAlignment="Center" />
                                        <ToggleSwitch x:Name="AutoOpenGeneratedBox" IsOn="True" />
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" Spacing="8" VerticalAlignment="Center">
                                        <TextBlock Text="Watermark" VerticalAlignment="Center" />
                                        <ToggleSwitch x:Name="EnableWatermarkBox" IsOn="False" />
                                    </StackPanel>
                                    <TextBox x:Name="WatermarkTextBox" Width="130" PlaceholderText="DRAFT" Text="DRAFT" />
                                    <Button x:Name="OpenLastGeneratedButton" Content="Open Last Generated" Click="OpenLastGeneratedButton_Click" Background="#FFD8DADF" />
                                </StackPanel>
                                <TextBlock x:Name="TemplatePathText" Text="Template: (not selected)" Foreground="#FF555F6B" TextWrapping="Wrap" />
                            </StackPanel>
                        </Border>

                        <Border Grid.Row="1" Background="#FFFFFFFF" CornerRadius="14" Padding="16" BorderBrush="#FFD7DBE0" BorderThickness="1">
                            <Grid RowSpacing="8">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="*" />
                                </Grid.RowDefinitions>
                                <TextBlock x:Name="GeneratedPathText" Text="Generated file path will appear here." Foreground="#FF555F6B" TextWrapping="Wrap" />
                                <TextBox Grid.Row="1" x:Name="OutputBox" TextWrapping="Wrap" AcceptsReturn="True" IsReadOnly="True" ScrollViewer.VerticalScrollBarVisibility="Auto" />
                            </Grid>
                        </Border>
                    </Grid>
                </controls:TabViewItem>
            </controls:TabView>
        </Border>

        <Border Grid.Row="2" Margin="20,10,20,18" Background="#FFD7D8DD" CornerRadius="12" Padding="12" BorderBrush="#FFCBCCD1" BorderThickness="1">
            <TextBlock x:Name="StatusText" Text="Ready" Opacity="0.84" />
        </Border>
    </Grid>
</Window>
